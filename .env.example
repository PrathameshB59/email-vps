# HTTP service (run behind Nginx in production)
HOST=127.0.0.1
PORT=8081

# Mail API security (local-only + bearer token)
MAIL_API_TOKEN=replace_with_strong_mail_api_token
MAIL_ALLOW_NON_LOCAL=false

# Mail envelope and delivery policy
MAIL_FROM=Email VPS <you@example.com>
MAIL_DAILY_LIMIT=500
MAIL_RETRY_MAX=3
MAIL_RETRY_BASE_MS=30000

# Relay (Postfix local relay expected)
MAIL_RELAY_HOST=127.0.0.1
MAIL_RELAY_PORT=25
MAIL_RELAY_SECURE=false

# Persistence and queue workers
DB_PATH=/home/devuser/dev/email-vps/data/email_vps.sqlite
LOG_RETENTION_DAYS=30
QUEUE_POLL_MS=5000
QUEUE_BATCH_SIZE=20

# Unified dashboard auth/access
DASHBOARD_LOGIN_USER=owner
DASHBOARD_LOGIN_PASS=replace_with_strong_password
# Quote this value if it includes '#' or spaces.
DASHBOARD_SESSION_SECRET="replace_with_32_plus_char_random_secret"
DASHBOARD_SESSION_TTL_HOURS=12
DASHBOARD_AUTH_FLOW=otp_then_credentials
DASHBOARD_IP_ALLOWLIST_ENABLED=false
DASHBOARD_ALLOWED_IPS=127.0.0.1,::1
DASHBOARD_TRUST_PROXY=true
# Keep CSP in report-only during rollout; switch to true after validation.
DASHBOARD_CSP_ENFORCE=false
# HTTPS header hardening (seconds). 86400 = 1 day staged rollout.
DASHBOARD_HSTS_MAX_AGE=86400
DASHBOARD_LOCAL_FALLBACK_ENABLED=true
DASHBOARD_PREAUTH_TTL_MINUTES=5

# OTP-first login (public model, then credentials as step 2)
DASHBOARD_OTP_PRIMARY_ENABLED=true
# Keep this as a separate mailbox from sender for reliable visibility.
DASHBOARD_OTP_TO=owner-otp@example.com
DASHBOARD_OTP_FROM=Email VPS OTP <otp-sender@example.com>
DASHBOARD_OTP_DIAGNOSTICS_ENABLED=true
DASHBOARD_OTP_LENGTH=6
DASHBOARD_OTP_TTL_MINUTES=10
DASHBOARD_OTP_RESEND_COOLDOWN_SECONDS=60
DASHBOARD_OTP_MAX_ATTEMPTS=5
DASHBOARD_OTP_REQUEST_RATE_LIMIT=10
DASHBOARD_OTP_REQUEST_RATE_WINDOW_MS=900000
DASHBOARD_OTP_DAILY_LIMIT=50

# Dashboard analytics and retention
DASHBOARD_METRICS_PATH=/home/devuser/dev/email-vps/metrics.json
DASHBOARD_METRIC_SNAPSHOT_MINUTES=5
DASHBOARD_RETENTION_DAYS=90
DASHBOARD_ACTIVITY_TOP_N=20
DASHBOARD_ACTIVITY_REFRESH_SECONDS=5
DASHBOARD_OPS_COMMAND_RUNNER_ENABLED=false
DASHBOARD_OPS_COMMAND_TIMEOUT_SECONDS=180
DASHBOARD_OPS_COMMAND_COOLDOWN_SECONDS=90
DASHBOARD_OPS_COMMAND_MAX_OUTPUT_LINES=500
# UNIX socket daemon runner (recommended for sudo-controlled actions)
DASHBOARD_OPS_DAEMON_ENABLED=false
DASHBOARD_OPS_DAEMON_SOCKET_PATH=/run/email-vps-opsd.sock
DASHBOARD_OPS_DAEMON_HMAC_SECRET=replace_with_32_plus_char_random_secret
DASHBOARD_OPS_DAEMON_REQUEST_TTL_SECONDS=30
DASHBOARD_OPS_DAEMON_CONNECT_TIMEOUT_MS=5000
DASHBOARD_OPS_DAEMON_IO_TIMEOUT_MS=240000
# Systemd units mapped by daemon action allowlist
DASHBOARD_AIDE_CHECK_UNIT=email-vps-aide-check.service
DASHBOARD_AIDE_BASELINE_LIST_UNIT=email-vps-aide-baseline-list.service
DASHBOARD_AIDE_INIT_UNIT=email-vps-aide-init.service
DASHBOARD_FAIL2BAN_STATUS_UNIT=email-vps-fail2ban-status.service
DASHBOARD_POSTFIX_CHECK_UNIT=email-vps-postfix-check.service
DASHBOARD_RELAY_PROBE_UNIT=email-vps-relay-probe.service
DASHBOARD_CRONTAB_CHECK_UNIT=email-vps-crontab-check.service
DASHBOARD_RCLONE_SYNC_UNIT=email-vps-rclone-sync.service

# Rclone control diagnostics (monitor-only)
DASHBOARD_RCLONE_REMOTE=gdrive
DASHBOARD_RCLONE_TARGET=gdrive:vps/devuser
DASHBOARD_RCLONE_BACKUP_DIR=/home/devuser/backups
DASHBOARD_RCLONE_BACKUP_SCRIPT=/home/devuser/backup-nightly.sh
DASHBOARD_RCLONE_AUTOSYNC_SCRIPT=/home/devuser/auto-sync.sh
DASHBOARD_RCLONE_BACKUP_LOG=/home/devuser/backups/backup.log
DASHBOARD_RCLONE_SYNC_LOG=/home/devuser/backups/sync.log
DASHBOARD_RCLONE_CONFIG_PATH=/home/devuser/.config/rclone/rclone.conf
DASHBOARD_RCLONE_STALE_HOURS=24
DASHBOARD_RCLONE_AUTOSYNC_TRIGGER_ENABLED=true
DASHBOARD_RCLONE_AUTOSYNC_COOLDOWN_SECONDS=180

# Login abuse protection
DASHBOARD_LOGIN_RATE_LIMIT=5
DASHBOARD_LOGIN_RATE_WINDOW_MS=60000
DASHBOARD_LOGIN_LOCKOUT_MINUTES=15

# Manual dashboard mail probe
DASHBOARD_MAIL_PROBE_TO=you@example.com
DASHBOARD_MAIL_PROBE_COOLDOWN_SECONDS=300
